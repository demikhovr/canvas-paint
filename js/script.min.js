"use strict";!function(){var n=document.querySelector(".settings"),e=document.querySelector(".settings__line-form"),t=e.querySelectorAll(".setting"),i=e.querySelector(".setting--number-width"),o=e.querySelector(".setting--select-width"),r=e.querySelector(".setting--random-width"),a=e.querySelector(".setting--color"),s=e.querySelector(".setting--rainbow"),d=document.querySelector("#draw");d.width=window.innerWidth,d.height=window.innerHeight-d.offsetTop;var l=d.getContext("2d"),c=0,u=!1,h=!1,f=!0,g=0,v=0,m={lineWidth:["25","50","100","150"],strokeStyle:["#3498db"],lineCap:["round","square","butt"],globalCompositeOperation:["source-over","lighter","xor","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"]};function p(){d.removeEventListener("mousemove",y)}function y(e){l.strokeStyle=u?"hsl("+c+", 100%, 50%)":a.value,h?((100<=l.lineWidth||l.lineWidth<=1)&&(f=!f),f?l.lineWidth++:l.lineWidth--):l.lineWidth=i.value,l.beginPath(),l.moveTo(g,v),l.lineTo(e.offsetX,e.offsetY),l.stroke();var t=[e.offsetX,e.offsetY];g=t[0],v=t[1],c++}Array.from(t).forEach(function(e){var t,o,n=e.dataset.param;switch(e.tagName.toLowerCase()){case"select":e.appendChild((t=n,o=document.createDocumentFragment(),m[t].forEach(function(e){var t=document.createElement("option");t.value=e,t.textContent=""+e[0].toUpperCase()+e.slice(1),o.appendChild(t)}),o));break;case"input":e.value=m[n][0]}l[n]=e.value}),e.addEventListener("change",function(e){l[e.target.dataset.param]=e.target.value,"select"===e.target.tagName.toLowerCase()&&(i.value=e.target.value);e.target===s&&(u=s.checked);e.target===r&&(h=r.checked);a.disabled=u,o.disabled=h,i.disabled=h}),d.addEventListener("mousedown",function(e){l.beginPath(),l.moveTo(e.offsetX,e.offsetY),l.lineTo(e.offsetX,e.offsetY),l.stroke();var t=[e.offsetX,e.offsetY];g=t[0],v=t[1],d.addEventListener("mousemove",y)}),d.addEventListener("mouseup",p),d.addEventListener("mouseout",p);var T={};function b(e){for(var t=0;t<e.changedTouches.length;t++){var o=e.changedTouches[t];delete T[o.identifier]}}d.addEventListener("touchstart",function(e){e.preventDefault();for(var t=0;t<e.changedTouches.length;t++){var o=e.changedTouches[t];T[o.identifier]={x:o.pageX,y:o.pageY-n.offsetHeight},l.beginPath(),l.moveTo(T[o.identifier].x,T[o.identifier].y),l.lineTo(o.pageX,o.pageY-n.offsetHeight),l.stroke()}}),d.addEventListener("touchmove",function(e){e.preventDefault();for(var t=0;t<e.changedTouches.length;t++){var o=e.changedTouches[t];l.strokeStyle=u?"hsl("+c+", 100%, 50%)":a.value,h?((100<=l.lineWidth||l.lineWidth<=1)&&(f=!f),f?l.lineWidth++:l.lineWidth--):l.lineWidth=i.value,console.log(l.strokeStyle),l.beginPath(),l.moveTo(T[o.identifier].x,T[o.identifier].y),l.lineTo(o.pageX,o.pageY-n.offsetHeight),l.stroke(),T[o.identifier]={x:o.pageX,y:o.pageY-n.offsetHeight}}}),d.addEventListener("touchend",b),d.addEventListener("touchcancel",b)}();